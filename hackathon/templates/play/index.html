{% extends "base.html" %}
{% block head %}
<script src="https://js.hcaptcha.com/1/api.js?render=explicit" async defer></script>
<link rel="stylesheet" href="{{ url_for('static', filename='game.css') }}">
{% endblock %}
{%block title %}Minesweeper{% endblock %}

{% block main %}
<script src="{{ url_for("static", filename="gameover.js") }}" type="module"></script>
<nav class="navbar navbar-dark bg-dark px-3"> 
  <a class="navbar-brand fw-bold text-light" href="/">‚Üê Home</a>
</nav>
<dialog id="difficultySelection" class="rounded p-4 border-0" style="max-width: 500px;">
  <form method="dialog">
    <h4 class="text-center mb-3">Choose Difficulty</h4>

    <div class="form-check mb-3">
      <input class="form-check-input" type="radio" name="difficulty" value="easy" id="easy">
      <label class="form-check-label" for="easy">Easy</label>
      <p class="text-muted mb-3 ghost" data-difficulty="easy">8x8 grid, 10 bombs</p>
    </div>
    <div class="form-check mb-3">
      <input class="form-check-input" type="radio" name="difficulty" value="medium" id="medium" checked>
      <label class="form-check-label" for="medium">Medium</label>
      <p class="text-muted mb-3" data-difficulty="medium">16x16 grid, 40 bombs</p>
    </div>
    <div class="form-check mb-3">
      <input class="form-check-input" type="radio" name="difficulty" value="hard" id="hard">
      <label class="form-check-label" for="hard">Hard</label>
      <p class="text-muted mb-3 ghost" data-difficulty="hard">24x24 grid, 99 bombs</p>
    </div>
    <div class="form-check mb-3">
      <input class="form-check-input" type="radio" name="difficulty" value="custom" id="custom">
      <label class="form-check-label" for="custom">Custom</label>
    </div>

    <div id="custom-fields" class="d-none"> <!-- Custom fields for user input dropdown -->
      <p class="text-muted mb-3">Set your own grid size and bomb count.</p>
      <div class="mb-3">
        <label class="form-label" for="rC">Rows</label>
        <p id="row-count-error" class="mb-2 text-danger ghost">Required field for custom</p>
        <input id="rC" class="form-control" type="number" min="5" max="100">
      </div>
      <div class="mb-3">
        <label class="form-label" for="cC">Columns</label>
        <p id="col-count-error" class="mb-2 text-danger ghost">Required field for custom</p>
        <input id="cC" class="form-control" type="number" min="5" max="100">
      </div>
      <div class="mb-4">
        <label class="form-label" for="bC">Mines</label>
        <p id="bomb-count-error" class="mb-2 text-danger ghost"></p>
        <input id="bC" class="form-control" type="number" min="1">
      </div>
    </div>

    <div class="text-center">
      <button class="btn btn-primary" type="submit">Confirm</button>
    </div>
  </form>

  <script>
    document.querySelectorAll('input[name="difficulty"]').forEach(radio => {
      radio.addEventListener('change', () => {
        const customFields = document.getElementById('custom-fields');
        if (document.getElementById('custom').checked) {
          customFields.classList.remove('d-none');
        } else {
          customFields.classList.add('d-none');
        }
      });
    });
  </script>
</dialog>

<dialog id="end-game-modal">
</dialog>

<div class="bg-dark d-flex justify-content-center align-items-center min-vh-100">
  <div class="card bg-secondary text-light p-4 rounded shadow-lg">
    <h2 class="text-center mb-4"><i class="fas fa-bomb me-2"></i> Bootsweeper</h2>
    <p class="text-center text-light" id="current-difficulty">Difficulty: Medium</p>
    <div class="d-flex justify-content-between align-items-center mb-3">
      <button class="game-btn new-game" id="play-button">
  <i class="fas fa-redo me-2"></i>New Game
</button>
<button class="game-btn restart-game" id="restart-button">
  <i class="fas fa-play me-2"></i>Restart
  </button>
      <div class="text-dark">
        Elapsed Time: <span id="elapsed-time">00:00:00</span>
        <br>
        Bomb Count: <span id="bomb-count"></span>
      </div>
    </div>

<div class="board neon-border">      
      <!-- Cells are generated via JavaScript -->
    </div>
</div>

  <!-- Game Logic -->
  <script src="{{ url_for('static', filename='minesweeper.js') }}" type="module"></script>
</div>
{% endblock %}
